<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="AnagramsMapper">

    <select id="showAll" parameterType="Anagrams" resultType="Anagrams" fetchSize="500">
        --         BEGIN;
--         DECLARE curs2 CURSOR FOR
        SELECT distinct ARRAY_AGG(distinct word), wordSort
        FROM table_test
        GROUP BY wordSort
        HAVING COUNT(word) > 3;
--         FETCH forward 1000 from curs2;

    </select>

    <select id="createFunction">
        CREATE
            OR REPLACE FUNCTION sort1(x TEXT) returns TEXT AS
        $$
        SELECT string_agg(c, '') as s
        from (select unnest(regexp_split_to_array($1, '')) as c
              order by c) as t;

        $$
            LANGUAGE sql immutable;
    </select>
    <select id="createTable">
        DROP TABLE IF EXISTS table_test;
        CREATE TABLE IF NOT EXISTS table_test
        (

            word     varchar(20),
            wordSort varchar(20) GENERATED ALWAYS AS
                         (
                         sort1
                             (
                                 word
                             ) ) STORED
        );
    </select>
    <select id="write">
        COPY table_test (word) FROM 'C:\Users\andrei.lisa\IdeaProjects\qwe\folder\file3.txt';
    </select>

</mapper>